<% notif_count = 0 %>
<% notifs.each do |notification| %>
  <% if notif_count < 10 %>
  	<% dup_count = notifs.where(:category => notification.category, :destination_id => notification.destination_id).count %>
  
	  <% if dup_count > 1 %>
	    <% duplicates = notifs.where(:category => notification.category, :destination_id => notification.destination_id) %>
	    <% if notification == duplicates.first %>
	      <% case notification.category %>
	      <% when "share" %>
	        <% notification.message = "Your post was shared #{dup_count} times." %>
	      <% when "comment" %>
	        <% notification.message = "#{dup_count} comments were made on your post." %>
	      <% when "follow" %>
	        <% notification.message = "#{dup_count} users are now following you." %>
	      <% end %>
	      <%= render notification %>
	      <% notif_count += 1 %>
	    <% elsif notification.category == "other" %>
	      <%= render notification %>
	      <% notif_count += 1 %>
	    <% end %>
	  <% else %>
	  	<%= render notification %>
	    <% notif_count += 1 %>
	  <% end %>
  <% end %>

<% end %>